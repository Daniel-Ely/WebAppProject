@model WebApplicationProject_sucks.Models.ProfessionalPage

@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <link rel="stylesheet" href="~/Content/creatPost.css?ver=<?php echo rand(111,999)?" type="text/css">
    <title>Create</title>
</head>
<body>
    @using (Html.BeginForm())
    {
        @Html.AntiForgeryToken()
        <h4>New Professional Page</h4>
        <div class="form-horizontal">
            <div class="form-group">
                @Html.ValidationSummary(true, "", new { @class = "text-danger" })

                @Html.EditorFor(model => model.NameOfPage, new { htmlAttributes = new { @class = "form-control", placeholder = "Enter page name", @required = "required" } })

            </div>
                <div class="form-group">
                    <label>Select all the relevant categories </label><br />
                    @{
                        MyDB db = new MyDB();
                        List<SelectListItem> listOfCategories = new List<SelectListItem>();
                        string user = Session["UserName"].ToString();
                        foreach (var item in db.ProfessionalToCategories.Where(d => d.P_UserName == user).ToList())
                        {
                            listOfCategories.Add(new SelectListItem { Text = item.CategoryName, Value = item.CategoryName });
                        }
                    }

                    @Html.ListBox("selectedOptions", listOfCategories, new { @id = "selectedOptions" })
                    <label id="listValidator"></label>


                </div>
                @Html.HiddenFor(Model => Model.UserName, new { Value = Session["UserName"] })


                <div class="form-group">
                    <div class="col-md-offset-2 col-md-10">

                        <input type="button" value="Create" class="btn btn-default" onclick="submit()" /><br />

                        <input type="submit" id="submitMe" hidden /><br />

                        <a href="/ProfessionalPages/Cancel">Cancel</a>



                    </div>
                </div>
            </div>
            }

            <script>
                //validate listbox
                function submit() {
                    var values = $('#selectedOptions').val();
                    if (values == null) {
                        document.getElementById("listValidator").innerText = "Pick at least one option."
                    }
                    else {//corrupsond with the html helpers values.
                        document.getElementById("submitMe").click();
                    }


                }
            </script>

</body>
</html>
